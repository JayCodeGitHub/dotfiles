"use strict";var q=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var nt=q(de=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0});de.binarySearch=void 0;function cn(e,t){let n=0,r=e.length-1;for(;n<=r;){let i=Math.floor((n+r)/2),s=e[i];if(s<t)n=i+1;else if(s>t)r=i-1;else{n=i,r=i;break}}return Math.max(Math.min(n,r,e.length-1),0)}de.binarySearch=cn});var Te=q(J=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});J.track=J.resetOffsetStack=J.offsetStack=J.setTracking=void 0;var rt=!0,je=0;function an(e){rt=e}J.setTracking=an;function un(){je++}J.offsetStack=un;function fn(){je--}J.resetOffsetStack=fn;function ln(e,t=[]){return[new Proxy(e,{get(o,f,M){if(rt){if(f==="push")return n;if(f==="pop")return r;if(f==="shift")return i;if(f==="unshift")return s;if(f==="splice")return y;if(f==="sort")return b;if(f==="reverse")return u}return Reflect.get(o,f,M)}}),t];function n(...o){return t.push({stack:c(),length:o.length}),e.push(...o)}function r(){if(t.length){let o=t[t.length-1];o.length>1?o.length--:t.pop()}return e.pop()}function i(){if(t.length){let o=t[0];o.length>1?o.length--:t.shift()}return e.shift()}function s(...o){return t.unshift({stack:c(),length:o.length}),e.unshift(...o)}function y(o,f,...M){f===void 0&&(f=e.length-o);let O=0,F;for(let g=0;g<t.length;g++){let p=t[g],D=O;if(O=D+p.length,o>=D){F=g+1;let h=p.length;p.length=o-D,t.splice(F,0,{stack:p.stack,length:h-p.length});break}}if(F===void 0)throw new Error("Invalid splice operation");let d=f;for(let g=F;g<t.length;g++){let p=t[g];for(;d>0&&p.length>0;)p.length--,d--;if(d===0)break}return t.splice(F,0,{stack:c(),length:M.length}),e.splice(o,f,...M)}function b(o){return t.splice(0,t.length,{stack:c(),length:e.length}),e.sort(o)}function u(){return t.splice(0,t.length,{stack:c(),length:e.length}),e.reverse()}function c(){let f=new Error().stack.split(`
`)[3+je].trim();return f.endsWith(")")?f=f.slice(f.lastIndexOf("(")+1,-1):f=f.slice(f.lastIndexOf(" ")+1),f}}J.track=ln});var ot=q(it=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0})});var dt=q(V=>{"use strict";var dn=V&&V.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),ct=V&&V.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&dn(t,e,n)};Object.defineProperty(V,"__esModule",{value:!0});V.replaceRange=V.replaceSourceRange=V.replaceAll=V.replace=V.create=V.toString=V.getLength=void 0;var st=nt(),X=Te();ct(ot(),V);ct(Te(),V);function at(e){let t=0;for(let n of e)t+=typeof n=="string"?n.length:n[0].length;return t}V.getLength=at;function Ee(e){return e.map(t=>typeof t=="string"?t:t[0]).join("")}V.toString=Ee;function gn(e){return[[e,void 0,0]]}V.create=gn;function hn(e,t,...n){let i=Ee(e).match(t);if(i&&i.index!==void 0){let s=i.index,y=s+i[0].length;(0,X.offsetStack)(),Le(e,s,y,...n.map(b=>typeof b=="function"?b(i[0]):b)),(0,X.resetOffsetStack)()}}V.replace=hn;function pn(e,t,...n){let r=Ee(e),i=r.matchAll(t),s=r.length,y=0;for(let b of i)if(b.index!==void 0){let u=b.index+y,c=u+b[0].length;(0,X.offsetStack)(),Le(e,u,c,...n.map(f=>typeof f=="function"?f(b[0]):f)),(0,X.resetOffsetStack)();let o=at(e);y+=o-s,s=o}}V.replaceAll=pn;function mn(e,t,n,r,...i){for(let s of e)if(typeof s!="string"&&s[1]===t){let y=typeof s[2]=="number"?s[2]:s[2][0],b=typeof s[2]=="number"?s[2]+s[0].length:s[2][1];if(y<=n&&b>=r){let u=[];n>y&&u.push(ft(s,n-y));for(let c of i)u.push(c);return r<b&&u.push(lt(s,r-b)),ut(u),(0,X.offsetStack)(),e.splice(e.indexOf(s),1,...u),(0,X.resetOffsetStack)(),!0}}return!1}V.replaceSourceRange=mn;function Le(e,t,n,...r){let i=Sn(e),s=(0,st.binarySearch)(i,t),y=(0,st.binarySearch)(i,n),b=e[s],u=e[y],c=i[s],o=i[y],f=i[y]+(typeof u=="string"?u.length:u[0].length),M=[];t>c&&M.push(ft(b,t-c));for(let O of r)M.push(O);n<f&&M.push(lt(u,n-o)),ut(M),(0,X.offsetStack)(),e.splice(s,y-s+1,...M),(0,X.resetOffsetStack)()}V.replaceRange=Le;function ut(e){for(let t=e.length-1;t>=1;t--)typeof e[t]=="string"&&typeof e[t-1]=="string"&&(e[t-1]=e[t-1]+e[t],(0,X.offsetStack)(),e.splice(t,1),(0,X.resetOffsetStack)())}function ft(e,t){if(typeof e=="string")return e.slice(0,t);let n=e[0],r=e[2],i=n.slice(0,t),s=typeof r=="number"?r:[r[0],r[1]-(n.length-i.length)];return[i,e[1],s,...e.slice(3)]}function lt(e,t){if(typeof e=="string")return e.slice(t);let n=e[0],r=e[2],i=n.slice(t);t<0&&(t+=n.length);let s=typeof r=="number"?r+t:[r[0]+t,r[1]];return[i,e[1],s,...e.slice(3)]}function Sn(e){let t=[],n=0;for(let r of e)t.push(n),n+=typeof r=="string"?r.length:r[0].length;return t}});var Ve=q(z=>{"use strict";var yn=z&&z.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),bn=z&&z.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&yn(t,e,n)};Object.defineProperty(z,"__esModule",{value:!0});z.buildStacks=z.buildMappings=z.SourceMap=void 0;bn(dt(),z);var qe=class{get memo(){if(!this._memo){let n=function(r){let i=new Set;for(let b of t.mappings)i.add(b[r][0]),i.add(b[r][1]);let s=[...i].sort((b,u)=>b-u).map(b=>({offset:b,mappings:new Set}));for(let b of t.mappings){let u=y(b[r][0]),c=y(b[r][1]);for(let o=u;o<=c;o++)s[o].mappings.add(b)}return s;function y(b){let u=0,c=s.length-1;for(;u<=c;){let o=Math.floor((u+c)/2),f=s[o];if(f.offset<b)u=o+1;else if(f.offset>b)c=o-1;else return o}}},t=this;this._memo={sourceRange:n("sourceRange"),generatedRange:n("generatedRange")}}return this._memo}constructor(t){this.mappings=t}toSourceOffset(t,n=!1){for(let r of this.matching(t,"generatedRange","sourceRange",n))return r}toGeneratedOffset(t,n=!1){for(let r of this.matching(t,"sourceRange","generatedRange",n))return r}toSourceOffsets(t,n=!1){return this.matching(t,"generatedRange","sourceRange",n)}toGeneratedOffsets(t,n=!1){return this.matching(t,"sourceRange","generatedRange",n)}*matching(t,n,r,i){let s=this.memo[n];if(s.length===0)return;let{low:y,high:b}=this.binarySearchMemo(s,t),u=new Set;for(let c=y;c<=b;c++)for(let o of s[c].mappings){if(u.has(o))continue;u.add(o);let f=this.matchOffset(t,o[n],o[r],i);f!==void 0&&(yield[f,o])}}matchOffset(t,n,r,i){if(t>=n[0]&&t<=n[1]){let s=r[0]+t-n[0];if(i&&(s+=r[1]-r[0]-(n[1]-n[0])),s>=r[0]&&s<=r[1])return s}}binarySearchMemo(t,n){let r=0,i=t.length-1;for(;r<=i;){let s=Math.floor((r+i)/2),y=t[s];if(y.offset<n)r=s+1;else if(y.offset>n)i=s-1;else{r=s,i=s;break}}return{low:Math.max(Math.min(r,i,t.length-1),0),high:Math.min(Math.max(r,i,0),t.length-1)}}};z.SourceMap=qe;function vn(e){let t=0,n=[];for(let r of e)typeof r=="string"?t+=r.length:(n.push({generatedRange:[t,t+r[0].length],source:r[1],sourceRange:typeof r[2]=="number"?[r[2],r[2]+r[0].length]:r[2],data:r[3]}),t+=r[0].length);return n}z.buildMappings=vn;function _n(e,t){let n=0,r=0,i=[];for(let s of t){let y=n;for(let b=0;b<s.length;b++){let u=e[r+b];typeof u=="string"?n+=u.length:n+=u[0].length}r+=s.length,i.push({range:[y,n],source:s.stack})}return i}z.buildStacks=_n});var ke=q(H=>{"use strict";var Fn=H&&H.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),xn=H&&H.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Pn=H&&H.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)n!=="default"&&Object.prototype.hasOwnProperty.call(e,n)&&Fn(t,e,n);return xn(t,e),t};Object.defineProperty(H,"__esModule",{value:!0});H.MirrorMap=void 0;var Mn=Pn(Ve()),Ie=class extends Mn.SourceMap{*findMirrorOffsets(t){for(let n of this.toGeneratedOffsets(t))yield[n[0],n[1].data[1]];for(let n of this.toSourceOffsets(t))yield[n[0],n[1].data[0]]}};H.MirrorMap=Ie});var We=q(ne=>{"use strict";Object.defineProperty(ne,"__esModule",{value:!0});ne.forEachEmbeddedFile=ne.updateVirtualFileMaps=ne.createVirtualFiles=void 0;var wn=Ve(),Cn=ke();function On(e){let t=new Map,n=new Map,r=new WeakMap,i=new WeakMap;return{allSources(){return Array.from(t.values())},updateSource(c,o,f){let M=Q(c),O=t.get(M);if(O)return O.languageId!==f?(this.deleteSource(c),this.updateSource(c,o,f)):(O.snapshot=o,s(O),O.language.updateVirtualFile(O.root,o),y(O),O.root);for(let F of e){let d=F.createVirtualFile(c,o,f);if(d){let g={fileName:c,languageId:f,snapshot:o,root:d,language:F};return t.set(M,g),y(g),d}}},deleteSource(c){let o=Q(c),f=t.get(o);f&&(f.language.deleteVirtualFile?.(f.root),t.delete(o),s(f))},getSource(c){let o=Q(c);return t.get(o)},hasSource:c=>t.has(Q(c)),getMirrorMap:u,getMaps:b,hasVirtualFile(c){return!!n.get(Q(c))},getVirtualFile(c){let o=n.get(Q(c));return o?[o.virtualFile,o.source]:[void 0,void 0]}};function s(c){ge(c.root,o=>{n.delete(Q(o.fileName))})}function y(c){ge(c.root,o=>{n.set(Q(o.fileName),{virtualFile:o,source:c})})}function b(c){return r.has(c.snapshot)||r.set(c.snapshot,new Map),gt(c,o=>{if(o){let f=t.get(Q(o));return[o,f.snapshot]}else{let f=n.get(Q(c.fileName)).source;return[f.fileName,f.snapshot]}},r.get(c.snapshot)),r.get(c.snapshot)}function u(c){return i.has(c.snapshot)||i.set(c.snapshot,c.mirrorBehaviorMappings?new Cn.MirrorMap(c.mirrorBehaviorMappings):void 0),i.get(c.snapshot)}}ne.createVirtualFiles=On;function gt(e,t,n=new Map){let r=new Set;for(let i of e.mappings){if(r.has(i.source))continue;r.add(i.source);let s=t(i.source);s&&(!n.has(s[0])||n.get(s[0])[0]!==s[1])&&n.set(s[0],[s[1],new wn.SourceMap(e.mappings.filter(y=>y.source===i.source))])}return n}ne.updateVirtualFileMaps=gt;function ge(e,t){t(e);for(let n of e.embeddedFiles)ge(n,t)}ne.forEachEmbeddedFile=ge;function Q(e){return e.replace(/\\/g,"/").toLowerCase()}});var ht=q(he=>{"use strict";Object.defineProperty(he,"__esModule",{value:!0});he.createLanguageContext=void 0;var Dn=We();function Rn(e,t){let n=e,r=new Map,i,s=(0,Dn.createVirtualFiles)(t);for(let b of t.reverse())if(b.resolveHost){let u=n,c=b.resolveHost(n);c===u&&(console.warn("[volar] language.resolveHost() should not return the same host instance."),c={...c}),n=new Proxy(c,{get(o,f){return f in o?o[f]:u[f]}})}return{rawHost:e,host:n,virtualFiles:new Proxy(s,{get:(b,u)=>(y(),b[u])})};function y(){let b=n.getProjectVersion();if(!(b!==i))return;let c=new Map,o=new Set(r.keys());for(let f of n.getScriptFileNames())c.set(f,n.getScriptSnapshot(f));for(let[f,M]of c)o.delete(f),r.get(f)!==c.get(f)&&(M?s.updateSource(f,M,n.getLanguageId?.(f)):s.deleteSource(f));for(let f of o)s.deleteSource(f);r=c,i=b}}he.createLanguageContext=Rn});var bt=q(Y=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0});Y.FileKind=Y.MirrorBehaviorCapabilities=Y.FileRangeCapabilities=Y.FileCapabilities=void 0;var pt;(function(e){e.full={diagnostic:!0,foldingRange:!0,documentFormatting:!0,documentSymbol:!0,codeAction:!0,inlayHint:!0}})(pt||(Y.FileCapabilities=pt={}));var mt;(function(e){e.full={hover:!0,references:!0,definition:!0,rename:!0,completion:!0,diagnostic:!0,semanticTokens:!0}})(mt||(Y.FileRangeCapabilities=mt={}));var St;(function(e){e.full={references:!0,definition:!0,rename:!0}})(St||(Y.MirrorBehaviorCapabilities=St={}));var yt;(function(e){e[e.TextFile=0]="TextFile",e[e.TypeScriptHostFile=1]="TypeScriptHostFile"})(yt||(Y.FileKind=yt={}))});var oe=q(Z=>{"use strict";var An=Z&&Z.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),pe=Z&&Z.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&An(t,e,n)};Object.defineProperty(Z,"__esModule",{value:!0});pe(We(),Z);pe(ht(),Z);pe(ke(),Z);pe(bt(),Z)});var _t=q(me=>{"use strict";Object.defineProperty(me,"__esModule",{value:!0});me.getDocumentRegistry=void 0;var vt=[];function jn(e,t,n){let r=vt.find(i=>i[0]===t&&i[1]===n)?.[2];return r||(r=e.createDocumentRegistry(t,n),vt.push([t,n,r])),r}me.getDocumentRegistry=jn});var Ft=q(ye=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0});ye.decorateLanguageService=void 0;var Se=oe();function Tn(e,t,n){let r=t.organizeImports.bind(t),i=t.getDefinitionAtPosition.bind(t),s=t.getDefinitionAndBoundSpan.bind(t),y=t.getTypeDefinitionAtPosition.bind(t),b=t.getImplementationAtPosition.bind(t),u=t.getFileReferences.bind(t),c=t.findRenameLocations.bind(t),o=t.getReferencesAtPosition.bind(t),f=t.findReferences.bind(t);t.organizeImports=M,t.getDefinitionAtPosition=d,t.getDefinitionAndBoundSpan=h,t.getTypeDefinitionAtPosition=g,t.getImplementationAtPosition=p,t.findRenameLocations=D,t.getReferencesAtPosition=O,t.getFileReferences=F,t.findReferences=m;function M(w,C,x){let R=[],j=e.getSource(w.fileName)?.root;if(j)(0,Se.forEachEmbeddedFile)(j,E=>{E.kind===Se.FileKind.TypeScriptHostFile&&E.capabilities.codeAction&&(R=R.concat(r({...w,fileName:E.fileName},C,x)))});else return r(w,C,x);return R.map(l).filter(se)}function O(w,C){return v(w,C,"references")}function F(w){return v(w,-1,"fileReferences")}function d(w,C){return v(w,C,"definition")}function g(w,C){return v(w,C,"typeDefinition")}function p(w,C){return v(w,C,"implementation")}function D(w,C,x,R,j){return v(w,C,"rename",x,R,j)}function v(w,C,x,R=!1,j=!1,E){let k=new Set,W=[];return G(w,C),W.map(L=>S(L,x==="definition")).filter(se);function G(L,K){if(k.has(L+":"+K))return;k.add(L+":"+K);let te=x==="definition"?i(L,K):x==="typeDefinition"?y(L,K):x==="references"?o(L,K):x==="fileReferences"?u(L):x==="implementation"?b(L,K):x==="rename"&&E?c(L,K,R,j,E):void 0;if(te){W=W.concat(te);for(let U of te){k.add(U.fileName+":"+U.textSpan.start);let[ie]=_(U.fileName);if(!ie)continue;let et=e.getMirrorMap(ie);if(et)for(let[tt,Ae]of et.findMirrorOffsets(U.textSpan.start))(x==="definition"||x==="typeDefinition"||x==="implementation")&&!Ae.definition||x==="references"&&!Ae.references||x==="rename"&&!Ae.rename||k.has(U.fileName+":"+tt)||G(U.fileName,tt)}}}}function h(w,C){let x=new Set,R,j=[];if(E(w,C),!R)return;return{textSpan:R,definitions:j?.map(k=>S(k,!0)).filter(se)};function E(k,W){if(x.has(k+":"+W))return;x.add(k+":"+W);let G=s(k,W);if(G&&(R||(R=G.textSpan),!!G.definitions)){j=j.concat(G.definitions);for(let L of G.definitions){x.add(L.fileName+":"+L.textSpan.start);let[K]=_(L.fileName);if(!K)continue;let te=e.getMirrorMap(K);if(te)for(let[U,ie]of te.findMirrorOffsets(L.textSpan.start))ie.definition&&(x.has(L.fileName+":"+U)||E(L.fileName,U))}}}}function m(w,C){let x=new Set,R=[];return j(w,C),R.map(E=>a(E)).filter(se);function j(E,k){if(x.has(E+":"+k))return;x.add(E+":"+k);let W=f(E,k);if(W){R=R.concat(W);for(let G of W)for(let L of G.references){x.add(L.fileName+":"+L.textSpan.start);let[K]=_(L.fileName);if(!K)continue;let te=e.getMirrorMap(K);if(te)for(let[U,ie]of te.findMirrorOffsets(L.textSpan.start))ie.references&&(x.has(L.fileName+":"+U)||j(L.fileName,U))}}}}function l(w){let[C,x]=_(w.fileName);return x?{...w,fileName:x.fileName,textChanges:w.textChanges.map(R=>{let j=P(w.fileName,R.span);if(j)return{...R,span:j.textSpan}}).filter(se)}:w}function a(w){let C=S(w.definition,!1),x=w.references.map(R=>S(R,!1)).filter(se);if(C)return{definition:C,references:x};if(x.length)return{definition:{...w.definition,fileName:x[0].fileName,textSpan:x[0].textSpan},references:x}}function S(w,C){let x=P(w.fileName,w.textSpan);if(C&&!x){let[k,W]=_(w.fileName);k&&W&&(x={fileName:W.fileName,textSpan:{start:0,length:0}})}if(!x)return;let R=P(w.fileName,w.contextSpan),j=P(w.originalFileName,w.originalTextSpan),E=P(w.originalFileName,w.originalContextSpan);return{...w,fileName:x.fileName,textSpan:x.textSpan,contextSpan:R?.textSpan,originalFileName:j?.fileName,originalTextSpan:j?.textSpan,originalContextSpan:E?.textSpan}}function P(w,C){if(!w||!C)return;let[x,R]=_(w);if(x&&R){n&&(C={start:C.start-R.snapshot.getLength(),length:C.length});for(let[j,[E,k]]of e.getMaps(x)){if(R.snapshot!==E)continue;let W=k.toSourceOffset(C.start);if(W)return{fileName:R.fileName,textSpan:{start:W[0],length:C.length}}}}else return{fileName:w,textSpan:C}}function _(w){if(n){let C,x=e.getSource(w);return x&&(0,Se.forEachEmbeddedFile)(x.root,R=>{let j=R.fileName.replace(w,"");R.kind===Se.FileKind.TypeScriptHostFile&&(j===".d.ts"||j.match(/^\.(js|ts)x?$/))&&(C=R)}),[C,x]}else return e.getVirtualFile(w)}}ye.decorateLanguageService=Tn;function se(e){return e!=null}});var Ke=q(A=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});A.startsWith=A.createGetCanonicalFileName=A.stringContains=A.endsWith=A.getStringComparer=A.compareStringsCaseSensitive=A.equateStringsCaseSensitive=A.equateStringsCaseInsensitive=A.last=A.lastOrUndefined=A.sort=A.some=A.flatMap=A.flatten=A.map=A.indexOfAnyCharCode=A.findIndex=A.every=void 0;var En=[];function Ln(e,t){if(e){for(let n=0;n<e.length;n++)if(!t(e[n],n))return!1}return!0}A.every=Ln;function qn(e,t,n){if(e===void 0)return-1;for(let r=n??0;r<e.length;r++)if(t(e[r],r))return r;return-1}A.findIndex=qn;function Vn(e,t,n=Ct){if(e){for(let r of e)if(n(r,t))return!0}return!1}function In(e,t,n){for(let r=n||0;r<e.length;r++)if(Vn(t,e.charCodeAt(r)))return r;return-1}A.indexOfAnyCharCode=In;function kn(e,t){let n;if(e){n=[];for(let r=0;r<e.length;r++)n.push(t(e[r],r))}return n}A.map=kn;function Wn(e){let t=[];for(let n of e)n&&(wt(n)?Mt(t,n):t.push(n));return t}A.flatten=Wn;function Kn(e,t){let n;if(e)for(let r=0;r<e.length;r++){let i=t(e[r],r);i&&(wt(i)?n=Mt(n,i):n=Bn(n,i))}return n||En}A.flatMap=Kn;function zn(e,t){if(e)if(t){for(let n of e)if(t(n))return!0}else return e.length>0;return!1}A.some=zn;function Bn(e,t){return t===void 0?e:e===void 0?[t]:(e.push(t),e)}function xt(e,t){return t<0?e.length+t:t}function Mt(e,t,n,r){if(t===void 0||t.length===0)return e;if(e===void 0)return t.slice(n,r);n=n===void 0?0:xt(t,n),r=r===void 0?t.length:xt(t,r);for(let i=n;i<r&&i<t.length;i++)t[i]!==void 0&&e.push(t[i]);return e}function Un(e,t){return e.length===0?e:e.slice().sort(t)}A.sort=Un;function Nn(e){return e===void 0||e.length===0?void 0:e[e.length-1]}A.lastOrUndefined=Nn;function $n(e){return e[e.length-1]}A.last=$n;function wt(e){return Array.isArray?Array.isArray(e):e instanceof Array}function Gn(e){return e}function Jn(e){return e.toLowerCase()}var Pt=/[^\u0130\u0131\u00DFa-z0-9\\/:\-_\. ]+/g;function Xn(e){return Pt.test(e)?e.replace(Pt,Jn):e}function Ct(e,t){return e===t}function Hn(e,t){return e===t||e!==void 0&&t!==void 0&&e.toUpperCase()===t.toUpperCase()}A.equateStringsCaseInsensitive=Hn;function Qn(e,t){return Ct(e,t)}A.equateStringsCaseSensitive=Qn;function Yn(e,t){return e===t?0:e===void 0?-1:t===void 0?1:e<t?-1:1}function Zn(e,t){return e===t?0:e===void 0?-1:t===void 0?1:(e=e.toUpperCase(),t=t.toUpperCase(),e<t?-1:e>t?1:0)}function Ot(e,t){return Yn(e,t)}A.compareStringsCaseSensitive=Ot;function er(e){return e?Zn:Ot}A.getStringComparer=er;function tr(e,t){let n=e.length-t.length;return n>=0&&e.indexOf(t,n)===n}A.endsWith=tr;function nr(e,t){return e.indexOf(t)!==-1}A.stringContains=nr;function rr(e){return e?Gn:Xn}A.createGetCanonicalFileName=rr;function ir(e,t){return e.lastIndexOf(t,0)===0}A.startsWith=ir});var Lt=q(T=>{"use strict";Object.defineProperty(T,"__esModule",{value:!0});T.containsPath=T.removeTrailingDirectorySeparator=T.normalizePath=T.getNormalizedPathComponents=T.combinePaths=T.getDirectoryPath=T.fileExtensionIsOneOf=T.hasExtension=T.isRootedDiskPath=T.directorySeparator=void 0;var ee=Ke();T.directorySeparator="/";var or="\\",Dt="://",sr=/\\/g;function cr(e){return e===47||e===92}function ar(e){return Tt(e)>0}T.isRootedDiskPath=ar;function ur(e){return(0,ee.stringContains)(Et(e),".")}T.hasExtension=ur;function fr(e,t){return e.length>t.length&&(0,ee.endsWith)(e,t)}function lr(e,t){for(let n of t)if(fr(e,n))return!0;return!1}T.fileExtensionIsOneOf=lr;function ze(e){return e.length>0&&cr(e.charCodeAt(e.length-1))}function Rt(e){return e>=97&&e<=122||e>=65&&e<=90}function dr(e,t){let n=e.charCodeAt(t);if(n===58)return t+1;if(n===37&&e.charCodeAt(t+1)===51){let r=e.charCodeAt(t+2);if(r===97||r===65)return t+3}return-1}function Tt(e){if(!e)return 0;let t=e.charCodeAt(0);if(t===47||t===92){if(e.charCodeAt(1)!==t)return 1;let r=e.indexOf(t===47?T.directorySeparator:or,2);return r<0?e.length:r+1}if(Rt(t)&&e.charCodeAt(1)===58){let r=e.charCodeAt(2);if(r===47||r===92)return 3;if(e.length===2)return 2}let n=e.indexOf(Dt);if(n!==-1){let r=n+Dt.length,i=e.indexOf(T.directorySeparator,r);if(i!==-1){let s=e.slice(0,n),y=e.slice(r,i);if(s==="file"&&(y===""||y==="localhost")&&Rt(e.charCodeAt(i+1))){let b=dr(e,i+2);if(b!==-1){if(e.charCodeAt(b)===47)return~(b+1);if(b===e.length)return~b}}return~(i+1)}return~e.length}return 0}function fe(e){let t=Tt(e);return t<0?~t:t}function gr(e){e=le(e);let t=fe(e);return t===e.length?e:(e=Fe(e),e.slice(0,Math.max(t,e.lastIndexOf(T.directorySeparator))))}T.getDirectoryPath=gr;function Et(e,t,n){if(e=le(e),fe(e)===e.length)return"";e=Fe(e);let i=e.slice(Math.max(fe(e),e.lastIndexOf(T.directorySeparator)+1)),s=t!==void 0&&n!==void 0?pr(i,t,n):void 0;return s?i.slice(0,i.length-s.length):i}function At(e,t,n){if((0,ee.startsWith)(t,".")||(t="."+t),e.length>=t.length&&e.charCodeAt(e.length-t.length)===46){let r=e.slice(e.length-t.length);if(n(r,t))return r}}function hr(e,t,n){if(typeof t=="string")return At(e,t,n)||"";for(let r of t){let i=At(e,r,n);if(i)return i}return""}function pr(e,t,n){if(t)return hr(Fe(e),t,n?ee.equateStringsCaseInsensitive:ee.equateStringsCaseSensitive);let r=Et(e),i=r.lastIndexOf(".");return i>=0?r.substring(i):""}function mr(e,t){let n=e.substring(0,t),r=e.substring(t).split(T.directorySeparator);return r.length&&!(0,ee.lastOrUndefined)(r)&&r.pop(),[n,...r]}function be(e,t=""){return e=_e(t,e),mr(e,fe(e))}function Sr(e){return e.length===0?"":(e[0]&&Be(e[0]))+e.slice(1).join(T.directorySeparator)}function le(e){return e.indexOf("\\")!==-1?e.replace(sr,T.directorySeparator):e}function ve(e){if(!(0,ee.some)(e))return[];let t=[e[0]];for(let n=1;n<e.length;n++){let r=e[n];if(r&&r!=="."){if(r===".."){if(t.length>1){if(t[t.length-1]!==".."){t.pop();continue}}else if(t[0])continue}t.push(r)}}return t}function _e(e,...t){e&&(e=le(e));for(let n of t)n&&(n=le(n),!e||fe(n)!==0?e=n:e=Be(e)+n);return e}T.combinePaths=_e;function yr(e,t){return ve(be(e,t))}T.getNormalizedPathComponents=yr;function br(e){if(e=le(e),!jt.test(e))return e;let t=e.replace(/\/\.\//g,"/").replace(/^\.\//,"");if(t!==e&&(e=t,!jt.test(e)))return e;let n=Sr(ve(be(e)));return n&&ze(e)?Be(n):n}T.normalizePath=br;function Fe(e){return ze(e)?e.substr(0,e.length-1):e}T.removeTrailingDirectorySeparator=Fe;function Be(e){return ze(e)?e:e+T.directorySeparator}var jt=/(?:\/\/)|(?:^|\/)\.\.?(?:$|\/)/;function vr(e,t,n,r){if(typeof n=="string"?(e=_e(n,e),t=_e(n,t)):typeof n=="boolean"&&(r=n),e===void 0||t===void 0)return!1;if(e===t)return!0;let i=ve(be(e)),s=ve(be(t));if(s.length<i.length)return!1;let y=r?ee.equateStringsCaseInsensitive:ee.equateStringsCaseSensitive;for(let b=0;b<i.length;b++)if(!(b===0?ee.equateStringsCaseInsensitive:y)(i[b],s[b]))return!1;return!0}T.containsPath=vr});var Je=q(xe=>{"use strict";Object.defineProperty(xe,"__esModule",{value:!0});xe.matchFiles=void 0;var B=Ke(),I=Lt(),qt=/[^\w\s\/]/g,_r=[42,63],Fr=["node_modules","bower_components","jspm_packages"],$e=`(?!(${Fr.join("|")})(/|$))`,Vt={singleAsteriskRegexFragment:"([^./]|(\\.(?!min\\.js$))?)*",doubleAsteriskRegexFragment:`(/${$e}[^/.][^/]*)*?`,replaceWildcardCharacter:e=>Ge(e,Vt.singleAsteriskRegexFragment)},It={singleAsteriskRegexFragment:"[^/]*",doubleAsteriskRegexFragment:`(/${$e}[^/.][^/]*)*?`,replaceWildcardCharacter:e=>Ge(e,It.singleAsteriskRegexFragment)},kt={singleAsteriskRegexFragment:"[^/]*",doubleAsteriskRegexFragment:"(/.+?)?",replaceWildcardCharacter:e=>Ge(e,kt.singleAsteriskRegexFragment)},xr={files:Vt,directories:It,exclude:kt};function Ue(e,t,n){let r=Wt(e,t,n);return!r||!r.length?void 0:`^(${r.map(y=>`(${y})`).join("|")})${n==="exclude"?"($|/)":"$"}`}function Wt(e,t,n){if(!(e===void 0||e.length===0))return(0,B.flatMap)(e,r=>r&&Mr(r,t,n,xr[n]))}function Pr(e){return!/[.*?]/.test(e)}function Mr(e,t,n,{singleAsteriskRegexFragment:r,doubleAsteriskRegexFragment:i,replaceWildcardCharacter:s}){let y="",b=!1,u=(0,I.getNormalizedPathComponents)(e,t),c=(0,B.last)(u);if(n!=="exclude"&&c==="**")return;u[0]=(0,I.removeTrailingDirectorySeparator)(u[0]),Pr(c)&&u.push("**","*");let o=0;for(let f of u){if(f==="**")y+=i;else if(n==="directories"&&(y+="(",o++),b&&(y+=I.directorySeparator),n!=="exclude"){let M="";f.charCodeAt(0)===42?(M+="([^./]"+r+")?",f=f.substr(1)):f.charCodeAt(0)===63&&(M+="[^./]",f=f.substr(1)),M+=f.replace(qt,s),M!==f&&(y+=$e),y+=M}else y+=f.replace(qt,s);b=!0}for(;o>0;)y+=")?",o--;return y}function Ge(e,t){return e==="*"?t:e==="?"?"[^/]":"\\"+e}function wr(e,t,n,r,i){e=(0,I.normalizePath)(e),i=(0,I.normalizePath)(i);let s=(0,I.combinePaths)(i,e);return{includeFilePatterns:(0,B.map)(Wt(n,s,"files"),y=>`^${y}$`),includeFilePattern:Ue(n,s,"files"),includeDirectoryPattern:Ue(n,s,"directories"),excludePattern:Ue(t,s,"exclude"),basePaths:Or(e,n,r)}}function Ne(e,t){return new RegExp(e,t?"":"i")}function Cr(e,t,n,r,i,s,y,b,u){e=(0,I.normalizePath)(e),s=(0,I.normalizePath)(s);let c=wr(e,n,r,i,s),o=c.includeFilePatterns&&c.includeFilePatterns.map(p=>Ne(p,i)),f=c.includeDirectoryPattern&&Ne(c.includeDirectoryPattern,i),M=c.excludePattern&&Ne(c.excludePattern,i),O=o?o.map(()=>[]):[[]],F=new Map,d=(0,B.createGetCanonicalFileName)(i);for(let p of c.basePaths)g(p,(0,I.combinePaths)(s,p),y);return(0,B.flatten)(O);function g(p,D,v){let h=d(u(D));if(F.has(h))return;F.set(h,!0);let{files:m,directories:l}=b(p);for(let a of(0,B.sort)(m,B.compareStringsCaseSensitive)){let S=(0,I.combinePaths)(p,a),P=(0,I.combinePaths)(D,a);if(!(t&&!(0,I.fileExtensionIsOneOf)(S,t))&&!(M&&M.test(P)))if(!o)O[0].push(S);else{let _=(0,B.findIndex)(o,w=>w.test(P));_!==-1&&O[_].push(S)}}if(!(v!==void 0&&(v--,v===0)))for(let a of(0,B.sort)(l,B.compareStringsCaseSensitive)){let S=(0,I.combinePaths)(p,a),P=(0,I.combinePaths)(D,a);(!f||f.test(P))&&(!M||!M.test(P))&&g(S,P,v)}}}xe.matchFiles=Cr;function Or(e,t,n){let r=[e];if(t){let i=[];for(let s of t){let y=(0,I.isRootedDiskPath)(s)?s:(0,I.normalizePath)((0,I.combinePaths)(e,s));i.push(Dr(y))}i.sort((0,B.getStringComparer)(!n));for(let s of i)(0,B.every)(r,y=>!(0,I.containsPath)(y,s,e,!n))&&r.push(s)}return r}function Dr(e){let t=(0,B.indexOfAnyCharCode)(e,_r);return t<0?(0,I.hasExtension)(e)?(0,I.removeTrailingDirectorySeparator)((0,I.getDirectoryPath)(e)):e:e.substring(0,e.lastIndexOf(I.directorySeparator,t))}});var Ut=q(Pe=>{"use strict";Object.defineProperty(Pe,"__esModule",{value:!0});Pe.createLanguageServiceHost=void 0;var Kt=require("path"),Rr=Je(),Xe=new Map;function Ar(e,t,n,r){let i,s=0,y=[],b=new Set,u={...n,getCurrentDirectory:()=>e.host.workspacePath,getCompilationSettings:()=>e.host.getCompilationSettings(),getCancellationToken:e.host.getCancellationToken?()=>e.host.getCancellationToken():void 0,getLocalizedDiagnosticMessages:e.host.getLocalizedDiagnosticMessages?()=>e.host.getLocalizedDiagnosticMessages():void 0,getProjectReferences:e.host.getProjectReferences?()=>e.host.getProjectReferences():void 0,getDefaultLibFileName:h=>{try{return t.getDefaultLibFilePath(h)}catch{return`/node_modules/typescript/lib/${t.getDefaultLibFileName(h)}`}},useCaseSensitiveFileNames:()=>n.useCaseSensitiveFileNames,getNewLine:()=>n.newLine,readFile:h=>{let m=g(h);if(m)return m.getText(0,m.getLength())},readDirectory:O,getDirectories:F,directoryExists:D,fileExists:v,getProjectVersion:()=>s+":"+n.version,getTypeRootsVersion:()=>n.version??-1,getScriptFileNames:()=>y,getScriptVersion:p,getScriptSnapshot:g,getScriptKind(h){if(t){if(e.virtualFiles.hasSource(h))return t.ScriptKind.Deferred;switch(Kt.posix.extname(h)){case".js":return t.ScriptKind.JS;case".cjs":return t.ScriptKind.JS;case".mjs":return t.ScriptKind.JS;case".jsx":return t.ScriptKind.JSX;case".ts":return t.ScriptKind.TS;case".cts":return t.ScriptKind.TS;case".mts":return t.ScriptKind.TS;case".tsx":return t.ScriptKind.TSX;case".json":return t.ScriptKind.JSON;default:return t.ScriptKind.Unknown}}return 0}},c=new Map;if(e.host.resolveModuleName){let h=t.createModuleResolutionCache(u.getCurrentDirectory(),u.useCaseSensitiveFileNames?a=>a:a=>a.toLowerCase(),u.getCompilationSettings()),m=!!r?.onDidChangeWatchedFiles?.(()=>{h.clear()}),l=e.host.getProjectVersion();u.resolveModuleNameLiterals=(a,S,P,_,w)=>(!m&&l!==e.host.getProjectVersion()&&(l=e.host.getProjectVersion(),h.clear()),a.map(C=>{let x=C.text;return x=e.host.resolveModuleName(x,w.impliedNodeFormat),t.resolveModuleName(x,S,_,u,h,P,w.impliedNodeFormat)})),u.resolveModuleNames=(a,S,P,_,w,C)=>(!m&&l!==e.host.getProjectVersion()&&(l=e.host.getProjectVersion(),h.clear()),a.map(x=>(x=e.host.resolveModuleName(x,C?.impliedNodeFormat),t.resolveModuleName(x,S,w,u,h,_,C?.impliedNodeFormat).resolvedModule)))}let o=new Set,f=new Set;return new Proxy(u,{get:(h,m)=>(M(),h[m])});function M(){let h=e.host.getProjectVersion();if(!(h!==i))return;i=h;let l=new Set,a=new Set;for(let{root:P}of e.virtualFiles.allSources())He(P,_=>{_.kind===1?l.add(_.snapshot):a.add(_.snapshot)});zt(o,l)?zt(f,a)&&s++:s++,o=l,f=a;let S=new Set;for(let{root:P}of e.virtualFiles.allSources())He(P,_=>{_.kind===1&&S.add(_.fileName)});for(let P of e.host.getScriptFileNames())e.virtualFiles.hasSource(P)||S.add(P);y=[...S],b.clear();for(let P of y)b.add(Kt.posix.dirname(Bt(P)))}function O(h,m,l,a,S){let P=(0,Rr.matchFiles)(h,m,l,a,n?.useCaseSensitiveFileNames??!1,e.host.workspacePath,S,_=>{let w=[];for(let C of y)if(C.toLowerCase().startsWith(_.toLowerCase())){let x=C.substring(_.length);x.indexOf("/")===-1&&w.push(x)}return{files:w,directories:d(_)}},n?.realpath?_=>n.realpath(_):_=>_);return P=P.map(_=>{let[w,C]=e.virtualFiles.getVirtualFile(_);return C?C.fileName:_}),[...new Set([...P,...n.readDirectory(h,m,l,a,S)])]}function F(h){return[...new Set([...d(h),...n.getDirectories(h)])]}function d(h){let m=new Set;for(let l of y)if(l.toLowerCase().startsWith(h.toLowerCase())){let a=l.substring(h.length);a.indexOf("/")>=0&&m.add(a.split("/")[0])}return[...m]}function g(h){let[m]=e.virtualFiles.getVirtualFile(h);if(m)return m.snapshot;let l=e.host.getScriptSnapshot(h);if(l)return l;let a=c.get(h),S=n.getModifiedTime?.(h)?.valueOf();if(!a||a[0]!==S)if(n.fileExists(h)){let P=n.readFile(h),_=P!==void 0?t.ScriptSnapshot.fromString(P):void 0;c.set(h,[S,_])}else c.set(h,[S,void 0]);return c.get(h)?.[1]}function p(h){let[m]=e.virtualFiles.getVirtualFile(h),l=m?.snapshot??e.host.getScriptSnapshot(h);if(l){Xe.has(h)||Xe.set(h,{lastVersion:0,snapshotVersions:new WeakMap});let a=Xe.get(h);return a.snapshotVersions.has(l)||a.snapshotVersions.set(l,a.lastVersion++),a.snapshotVersions.get(l).toString()}return n.getModifiedTime?.(h)?.valueOf().toString()??""}function D(h){return b.has(Bt(h))||n.directoryExists(h)}function v(h){let m=h.substring(h.lastIndexOf("."));if(m===".js"||m===".ts"||m===".jsx"||m===".tsx"){let l=h.substring(0,h.lastIndexOf("."));if(!e.virtualFiles.hasSource(l)){let a=g(l);a&&e.virtualFiles.updateSource(l,a,e.host.getLanguageId?.(l))}}return e.virtualFiles.hasVirtualFile(h)||e.host.getScriptSnapshot(h)?!0:!!n.fileExists(h)}}Pe.createLanguageServiceHost=Ar;function zt(e,t){if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0}function He(e,t){t(e);for(let n of e.embeddedFiles)He(n,t)}function Bt(e){return e.replace(/\\/g,"/").toLowerCase()}});var $t=q(Me=>{"use strict";Object.defineProperty(Me,"__esModule",{value:!0});Me.createSys=void 0;var $=require("path"),jr=Je(),Nt="";function Tr(e,t){let n=0,r=t.uriToFileName(t.workspaceUri.toString()),i=e.sys,s={dirs:new Map,files:new Map,requestedRead:!1},y=new Set,b=t.onDidChangeWatchedFiles?.(({changes:l})=>{for(let a of l){let S=t.uriToFileName(a.uri),P=$.posix.dirname(S),_=$.posix.basename(S),w=h(P);w.files.has(_)&&(n++,a.type===1||a.type===2?w.files.set(_,{stat:{type:1,ctime:Date.now(),mtime:Date.now(),size:-1},requestedStat:!1}):a.type===3&&w.files.set(_,{stat:void 0,text:void 0,requestedStat:!0,requestedText:!0}))}});return{get version(){return n},dispose(){b?.dispose()},args:i?.args??[],newLine:i?.newLine??`
`,useCaseSensitiveFileNames:i?.useCaseSensitiveFileNames??!1,realpath:i?.realpath,write:i?.write??(()=>{}),writeFile:i?.writeFile??(()=>{}),createDirectory:i?.createDirectory??(()=>{}),exit:i?.exit??(()=>{}),getExecutingFilePath:i?.getExecutingFilePath??(()=>r+"/__fake__.js"),getCurrentDirectory:()=>r,getModifiedTime:f,readFile:c,readDirectory:g,getDirectories:d,resolvePath:u,fileExists:M,directoryExists:o,async sync(){for(;y.size;)await Promise.all(y);return n}};function u(l){if(i){if(Nt!==r&&(Nt=r,i.directoryExists(r)))try{process.chdir(r)}catch{}return i.resolvePath(l).replace(/\\/g,"/")}return $.posix.resolve(l).replace(/\\/g,"/")}function c(l,a){l=u(l);let S=$.posix.dirname(l),P=h(S),_=$.posix.basename(l);return p(l,a,P),P.files.get(_)?.text}function o(l){l=u(l);let a=h(l);if(a.exists===void 0){a.exists=!1;let S=t.fs?.stat(t.fileNameToUri(l));if(typeof S=="object"&&"then"in S){let P=S;y.add(P),S.then(_=>{y.delete(P),a.exists=_?.type===2,a.exists&&n++})}else a.exists=S?.type===2}return a.exists}function f(l){l=u(l);let a=F(l);return a.requestedStat||(a.requestedStat=!0,O(l,a)),a.stat?new Date(a.stat.mtime):new Date(0)}function M(l){l=u(l);let a=F(l),S=()=>a.text!==void 0||a.stat?.type===1;return S()?!0:(a.requestedStat||(a.requestedStat=!0,O(l,a)),S())}function O(l,a){let S=t.fs?.stat(t.fileNameToUri(l));if(typeof S=="object"&&"then"in S){let P=S;y.add(P),S.then(_=>{y.delete(P),(a.stat?.type!==_?.type||a.stat?.mtime!==_?.mtime)&&n++,a.stat=_})}else a.stat=S}function F(l){l=u(l);let a=$.posix.dirname(l),S=$.posix.basename(l),P=h(a),_=P.files.get(S);return _||P.files.set(S,_={}),_}function d(l){return l=u(l),D(l),[...h(l).dirs.entries()].filter(([S,P])=>P.exists).map(([S])=>S)}function g(l,a,S,P,_){l=u(l);let w=(0,jr.matchFiles)(l,a,S,P,i?.useCaseSensitiveFileNames??!1,r,_,C=>{C=u(C),D(C);let x=h(C);return{files:[...x.files.entries()].filter(([R,j])=>j.stat?.type===1).map(([R])=>R),directories:[...x.dirs.entries()].filter(([R,j])=>j.exists).map(([R])=>R)}},i?.realpath?C=>i.realpath(C):C=>C);return[...new Set(w)]}function p(l,a,S){let P=$.posix.basename(l),_=S.files.get(P);if(_||S.files.set(P,_={}),_.requestedText)return;_.requestedText=!0;let w=t.fileNameToUri(l),C=t.fs?.readFile(w,a);if(typeof C=="object"&&"then"in C){let x=C;y.add(x),C.then(R=>{y.delete(x),R!==void 0&&(_.text=R,_.stat&&_.stat.mtime++,n++)})}else C!==void 0&&(_.text=C)}function D(l){let a=h(l);if(a.requestedRead)return;a.requestedRead=!0;let S=t.fs?.readDirectory(t.fileNameToUri(l||"."));if(typeof S=="object"&&"then"in S){let P=S;y.add(P),S.then(_=>{y.delete(P),v(l,a,_)&&n++})}else v(l,a,S??[])}function v(l,a,S){S=S.filter(([_])=>_!=="."&&_!=="..");let P=!1;for(let[_,w]of S){let C=w;if(C===64){let x=t.fs?.stat(t.fileNameToUri(l+"/"+_));if(typeof x=="object"&&"then"in x){let R=x;y.add(R),x.then(j=>{if(y.delete(R),j?.type===1){let E=a.files.get(_);E||a.files.set(_,E={}),(j.type!==E.stat?.type||j.mtime!==E.stat?.mtime)&&n++,E.stat=j,E.requestedStat=!0}else if(j?.type===2){let E=m(a,_);E.exists||(E.exists=!0,n++)}})}else x&&(C=x.type)}if(C===1){let x=a.files.get(_);x||a.files.set(_,x={}),x.stat||(x.stat={type:1,mtime:0,ctime:0,size:0},P=!0)}else if(C===2){let x=m(a,_);x.exists||(x.exists=!0,P=!0)}}return P}function h(l){let a=[],S=l,P=$.posix.basename(S),_;for(;_!==S;)_=S,a.push(P),S=$.posix.dirname(S),P=$.posix.basename(S);let w=s;for(let C=a.length-1;C>=0;C--){let x=a[C];w=m(w,x)}return w}function m(l,a){let S=l.dirs.get(a);return S||l.dirs.set(a,S={dirs:new Map,files:new Map}),S}}Me.createSys=Tr});var Gt=q(we=>{"use strict";Object.defineProperty(we,"__esModule",{value:!0});we.getProgram=void 0;function Er(e,t,n,r){let i={getRootFileNames:y,emit:M,getSyntacticDiagnostics:u,getSemanticDiagnostics:c,getGlobalDiagnostics:f,getBindAndCheckDiagnostics:b};return new Proxy({},{get:(F,d)=>{if(d in i)return i[d];let g=s();return d in g?g[d]:F[d]},set:(F,d,g)=>{let p=s();return F[d]=p[d]=g,!0}});function s(){return n.getProgram()}function y(){return s().getRootFileNames().filter(F=>r.fileExists?.(F))}function b(F,d){return o(F,d,"getBindAndCheckDiagnostics")}function u(F,d){return o(F,d,"getSyntacticDiagnostics")}function c(F,d){return o(F,d,"getSemanticDiagnostics")}function o(F,d,g){if(F){let[p,D]=t.virtualFiles.getVirtualFile(F.fileName);if(p&&D)return p.capabilities.diagnostic?O(n.getProgram()?.[g](F,d)??[]):[]}return O(s()[g](F,d)??[])}function f(F){return O(s().getGlobalDiagnostics(F)??[])}function M(F,d,g,p,D){let v=s().emit(F,r.writeFile??e.sys.writeFile,g,p,D);return{emitSkipped:v.emitSkipped,emittedFiles:v.emittedFiles,diagnostics:O(v.diagnostics)}}function O(F){let d=[];for(let p of F)if(p.file!==void 0&&p.start!==void 0&&p.length!==void 0){let[D,v]=t.virtualFiles.getVirtualFile(p.file.fileName);if(D&&v){if(r.fileExists?.(v.fileName)===!1)continue;for(let[h,[m,l]]of t.virtualFiles.getMaps(D))if(m===v.snapshot){for(let a of l.toSourceOffsets(p.start))if(typeof a[1].data.diagnostic=="object"?a[1].data.diagnostic.shouldReport():a[1].data.diagnostic){for(let P of l.toSourceOffsets(p.start+p.length,!0))if(typeof P[1].data.diagnostic=="object"?P[1].data.diagnostic.shouldReport():P[1].data.diagnostic){g(p,v.fileName,a[0],P[0],v.snapshot.getText(0,v.snapshot.getLength()));break}break}}}else{if(r.fileExists?.(p.file.fileName)===!1)continue;g(p,p.file.fileName,p.start,p.start+p.length,p.file.text)}}else p.file===void 0&&d.push(p);return d;function g(p,D,v,h,m){let l=D===p.file?.fileName?p.file:void 0;if(!l)if(m===void 0){let P=t.host.getScriptSnapshot(D);P&&(m=P.getText(0,P.getLength()))}else l=e.createSourceFile(D,m,e.ScriptTarget.Latest,void 0,e.ScriptKind.Deferred),l.originalFileName=D,l.path=D.toLowerCase(),l.resolvedPath=D.toLowerCase();let a={...p,file:l,start:v,length:h-v},S=p.relatedInformation;S&&(a.relatedInformation=O(S)),d.push(a)}}}we.getProgram=Er});var Ht=q(re=>{"use strict";Object.defineProperty(re,"__esModule",{value:!0});re.getExternalFiles=re.searchExternalFiles=re.decorateLanguageServiceHost=void 0;var Jt=oe();function Lr(e,t,n,r){let i=0,s=new Map,y=t.readDirectory?.bind(t),b=t.resolveModuleNameLiterals?.bind(t),u=t.resolveModuleNames?.bind(t),c=t.getProjectVersion?.bind(t),o=t.getScriptSnapshot.bind(t),f=t.getScriptKind?.bind(t);y&&(t.readDirectory=(d,g,p,D,v)=>{if(g)for(let h of r)g.includes(h)||(g=[...g,...h]);return y(d,g,p,D,v)}),b?t.resolveModuleNameLiterals=(d,g,p,D,...v)=>{let h=b(d,g,p,D,...v);return d.map((m,l)=>{if(r.some(a=>m.text.endsWith(a))){let a=M(m.text,g,D,p);if(a.resolvedModule)return a}return h[l]})}:u&&(t.resolveModuleNames=(d,g,p,D,v,h)=>{let m=u(d,g,p,D,v,h);return d.map((l,a)=>{if(r.some(S=>l.endsWith(S))){let S=M(l,g,v,D);if(S.resolvedModule)return S.resolvedModule}return m[a]})}),c&&(t.getProjectVersion=()=>c()+":"+i),t.getScriptSnapshot=d=>r.some(g=>d.endsWith(g))?(F(d),s.get(d)?.snapshot):o(d),f&&(t.getScriptKind=d=>{if(r.some(g=>d.endsWith(g))){F(d);let g=s.get(d);if(g){if(g.extension.endsWith(".js"))return n.ScriptKind.JS;if(g.extension.endsWith(".jsx"))return n.ScriptKind.JSX;if(g.extension.endsWith(".ts"))return n.ScriptKind.TS;if(g.extension.endsWith(".tsx"))return n.ScriptKind.TSX}return n.ScriptKind.Deferred}return f(d)});function M(d,g,p,D){let v=n.resolveModuleName(d,g,p,{readFile(h){return t.readFile(h)},fileExists(h){return r.some(m=>h.endsWith(m+".d.ts"))?O(h.slice(0,-5)):t.fileExists(h)}},void 0,D);if(v.resolvedModule){v.resolvedModule.resolvedFileName=v.resolvedModule.resolvedFileName.slice(0,-5);let h=F(v.resolvedModule.resolvedFileName);h&&(v.resolvedModule.extension=h.extension)}return v}function O(d){return t.fileExists(d)?(n.sys.getFileSize?.(d)??t.readFile(d)?.length??0)<4*1024*1024:!1}function F(d){let g=t.getScriptVersion(d);if(g!==s.get(d)?.version){let p=t.readFile(d),D,v=".ts";if(p!==void 0){i++;let h=e.updateSource(d,n.ScriptSnapshot.fromString(p),void 0);if(h){let m=p.split(`
`).map(l=>" ".repeat(l.length)).join(`
`);(0,Jt.forEachEmbeddedFile)(h,l=>{let a=l.fileName.substring(d.length);l.kind===Jt.FileKind.TypeScriptHostFile&&(a===".d.ts"||a.match(/^\.(js|ts)x?$/))&&(v=a,m+=l.snapshot.getText(0,l.snapshot.getLength()))}),D=n.ScriptSnapshot.fromString(m)}}else e.hasSource(d)&&(i++,e.deleteSource(d));s.set(d,{version:g,snapshot:D,extension:v})}return s.get(d)}}re.decorateLanguageServiceHost=Lr;function Xt(e,t,n){if(t.projectKind!==e.server.ProjectKind.Configured)return[];let r=t.getProjectName(),i=e.readJsonConfigFile(r,t.readFile.bind(t)),s={useCaseSensitiveFileNames:t.useCaseSensitiveFileNames(),fileExists:t.fileExists.bind(t),readFile:t.readFile.bind(t),readDirectory:(...b)=>(b[1]=n,t.readDirectory(...b))};return e.parseJsonSourceFileConfigFileContent(i,s,t.getCurrentDirectory()).fileNames}re.searchExternalFiles=Xt;re.getExternalFiles=Xt});var Qt=q(N=>{"use strict";var qr=N&&N.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),ce=N&&N.__exportStar||function(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&qr(t,e,n)};Object.defineProperty(N,"__esModule",{value:!0});ce(_t(),N);ce(Ft(),N);ce(Ut(),N);ce($t(),N);ce(Gt(),N);ce(Ht(),N)});var Zt=q((Ce,Yt)=>{(function(e,t){typeof Ce=="object"&&typeof Yt<"u"?t(Ce):typeof define=="function"&&define.amd?define(["exports"],t):(e=typeof globalThis<"u"?globalThis:e||self,t(e.sourcemapCodec={}))})(Ce,function(e){"use strict";let t=",".charCodeAt(0),n=";".charCodeAt(0),r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=new Uint8Array(64),s=new Uint8Array(128);for(let d=0;d<r.length;d++){let g=r.charCodeAt(d);i[d]=g,s[g]=d}let y=typeof TextDecoder<"u"?new TextDecoder:typeof Buffer<"u"?{decode(d){return Buffer.from(d.buffer,d.byteOffset,d.byteLength).toString()}}:{decode(d){let g="";for(let p=0;p<d.length;p++)g+=String.fromCharCode(d[p]);return g}};function b(d){let g=new Int32Array(5),p=[],D=0;do{let v=u(d,D),h=[],m=!0,l=0;g[0]=0;for(let a=D;a<v;a++){let S;a=c(d,a,g,0);let P=g[0];P<l&&(m=!1),l=P,o(d,a,v)?(a=c(d,a,g,1),a=c(d,a,g,2),a=c(d,a,g,3),o(d,a,v)?(a=c(d,a,g,4),S=[P,g[1],g[2],g[3],g[4]]):S=[P,g[1],g[2],g[3]]):S=[P],h.push(S)}m||f(h),p.push(h),D=v+1}while(D<=d.length);return p}function u(d,g){let p=d.indexOf(";",g);return p===-1?d.length:p}function c(d,g,p,D){let v=0,h=0,m=0;do{let a=d.charCodeAt(g++);m=s[a],v|=(m&31)<<h,h+=5}while(m&32);let l=v&1;return v>>>=1,l&&(v=-2147483648|-v),p[D]+=v,g}function o(d,g,p){return g>=p?!1:d.charCodeAt(g)!==t}function f(d){d.sort(M)}function M(d,g){return d[0]-g[0]}function O(d){let g=new Int32Array(5),p=1024*16,D=p-36,v=new Uint8Array(p),h=v.subarray(0,D),m=0,l="";for(let a=0;a<d.length;a++){let S=d[a];if(a>0&&(m===p&&(l+=y.decode(v),m=0),v[m++]=n),S.length!==0){g[0]=0;for(let P=0;P<S.length;P++){let _=S[P];m>D&&(l+=y.decode(h),v.copyWithin(0,D,m),m-=D),P>0&&(v[m++]=t),m=F(v,m,g,_,0),_.length!==1&&(m=F(v,m,g,_,1),m=F(v,m,g,_,2),m=F(v,m,g,_,3),_.length!==4&&(m=F(v,m,g,_,4)))}}}return l+y.decode(v.subarray(0,m))}function F(d,g,p,D,v){let h=D[v],m=h-p[v];p[v]=h,m=m<0?-m<<1|1:m<<1;do{let l=m&31;m>>>=5,m>0&&(l|=32),d[g++]=i[l]}while(m>0);return g}e.decode=b,e.encode=O,Object.defineProperty(e,"__esModule",{value:!0})})});var en=q((De,Oe)=>{var Vr=De&&De.__spreadArray||function(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,s;r<i;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))};(function(e){if(typeof Oe=="object"&&typeof Oe.exports=="object"){var t=e(require,De);t!==void 0&&(Oe.exports=t)}else typeof define=="function"&&define.amd&&define(["require","exports"],e)})(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextDocument=void 0;var n=function(){function u(c,o,f,M){this._uri=c,this._languageId=o,this._version=f,this._content=M,this._lineOffsets=void 0}return Object.defineProperty(u.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),u.prototype.getText=function(c){if(c){var o=this.offsetAt(c.start),f=this.offsetAt(c.end);return this._content.substring(o,f)}return this._content},u.prototype.update=function(c,o){for(var f=0,M=c;f<M.length;f++){var O=M[f];if(u.isIncremental(O)){var F=y(O.range),d=this.offsetAt(F.start),g=this.offsetAt(F.end);this._content=this._content.substring(0,d)+O.text+this._content.substring(g,this._content.length);var p=Math.max(F.start.line,0),D=Math.max(F.end.line,0),v=this._lineOffsets,h=s(O.text,!1,d);if(D-p===h.length)for(var m=0,l=h.length;m<l;m++)v[m+p+1]=h[m];else h.length<1e4?v.splice.apply(v,Vr([p+1,D-p],h,!1)):this._lineOffsets=v=v.slice(0,p+1).concat(h,v.slice(D+1));var a=O.text.length-(g-d);if(a!==0)for(var m=p+1+h.length,l=v.length;m<l;m++)v[m]=v[m]+a}else if(u.isFull(O))this._content=O.text,this._lineOffsets=void 0;else throw new Error("Unknown change event received")}this._version=o},u.prototype.getLineOffsets=function(){return this._lineOffsets===void 0&&(this._lineOffsets=s(this._content,!0)),this._lineOffsets},u.prototype.positionAt=function(c){c=Math.max(Math.min(c,this._content.length),0);var o=this.getLineOffsets(),f=0,M=o.length;if(M===0)return{line:0,character:c};for(;f<M;){var O=Math.floor((f+M)/2);o[O]>c?M=O:f=O+1}var F=f-1;return{line:F,character:c-o[F]}},u.prototype.offsetAt=function(c){var o=this.getLineOffsets();if(c.line>=o.length)return this._content.length;if(c.line<0)return 0;var f=o[c.line],M=c.line+1<o.length?o[c.line+1]:this._content.length;return Math.max(Math.min(f+c.character,M),f)},Object.defineProperty(u.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),u.isIncremental=function(c){var o=c;return o!=null&&typeof o.text=="string"&&o.range!==void 0&&(o.rangeLength===void 0||typeof o.rangeLength=="number")},u.isFull=function(c){var o=c;return o!=null&&typeof o.text=="string"&&o.range===void 0&&o.rangeLength===void 0},u}(),r;(function(u){function c(M,O,F,d){return new n(M,O,F,d)}u.create=c;function o(M,O,F){if(M instanceof n)return M.update(O,F),M;throw new Error("TextDocument.update: document must be created by TextDocument.create")}u.update=o;function f(M,O){for(var F=M.getText(),d=i(O.map(b),function(l,a){var S=l.range.start.line-a.range.start.line;return S===0?l.range.start.character-a.range.start.character:S}),g=0,p=[],D=0,v=d;D<v.length;D++){var h=v[D],m=M.offsetAt(h.range.start);if(m<g)throw new Error("Overlapping edit");m>g&&p.push(F.substring(g,m)),h.newText.length&&p.push(h.newText),g=M.offsetAt(h.range.end)}return p.push(F.substr(g)),p.join("")}u.applyEdits=f})(r||(t.TextDocument=r={}));function i(u,c){if(u.length<=1)return u;var o=u.length/2|0,f=u.slice(0,o),M=u.slice(o);i(f,c),i(M,c);for(var O=0,F=0,d=0;O<f.length&&F<M.length;){var g=c(f[O],M[F]);g<=0?u[d++]=f[O++]:u[d++]=M[F++]}for(;O<f.length;)u[d++]=f[O++];for(;F<M.length;)u[d++]=M[F++];return u}function s(u,c,o){o===void 0&&(o=0);for(var f=c?[o]:[],M=0;M<u.length;M++){var O=u.charCodeAt(M);(O===13||O===10)&&(O===13&&M+1<u.length&&u.charCodeAt(M+1)===10&&M++,f.push(o+M+1))}return f}function y(u){var c=u.start,o=u.end;return c.line>o.line||c.line===o.line&&c.character>o.character?{start:o,end:c}:u}function b(u){var c=y(u.range);return c!==u.range?{newText:u.newText,range:c}:u}})});var on=q(ae=>{"use strict";var Ir=ae&&ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ae,"__esModule",{value:!0});ae.astro2tsx=void 0;var kr=require("@astrojs/compiler/sync"),Wr=Zt(),tn=oe(),nn=Ir(require("node:path")),rn=en();function Kr(e,t){try{return(0,kr.convertToTSX)(e,{filename:t.filename})}catch(n){return console.error(`There was an error transforming ${t.filename} to TSX. An empty file will be returned instead. Please create an issue: https://github.com/withastro/language-tools/issues
Error: ${n}.`),{code:"",map:{file:t.filename??"",sources:[],sourcesContent:[],names:[],mappings:"",version:0},diagnostics:[{code:1e3,location:{file:t.filename,line:1,column:1,length:e.length},severity:1,text:"The Astro compiler encountered an unknown error while parsing this file. Please create an issue with your code and the error shown in the server's logs: https://github.com/withastro/language-tools/issues"}]}}}function zr(e,t,n){let r=Kr(e,{filename:t});return{virtualFile:Br(e,r,t,n),diagnostics:r.diagnostics}}ae.astro2tsx=zr;function Br(e,t,n,r){t.code=Ur(t.code,n);let i=(0,Wr.decode)(t.map.mappings),s=rn.TextDocument.create(n,"astro",0,e),y=rn.TextDocument.create(n+".tsx","typescriptreact",0,t.code),b=[],u;for(let o=0;o<i.length;o++)for(let f of i[o]){let M=f[0],O=y.offsetAt({line:o,character:M});if(u){let F=O-u.genOffset,d=e.substring(u.sourceOffset,u.sourceOffset+F),g=t.code.substring(u.genOffset,u.genOffset+F);if(d!==g){F=0;for(let p=0;p<O-u.genOffset&&d[p]===g[p];p++)F=p+1}if(F>0){let p=b.length?b[b.length-1]:void 0;p&&p.generatedRange[1]===u.genOffset&&p.sourceRange[1]===u.sourceOffset?(p.generatedRange[1]=u.genOffset+F,p.sourceRange[1]=u.sourceOffset+F):b.push({sourceRange:[u.sourceOffset,u.sourceOffset+F],generatedRange:[u.genOffset,u.genOffset+F],data:tn.FileRangeCapabilities.full})}u=void 0}if(f[2]!==void 0&&f[3]!==void 0){let F=s.offsetAt({line:f[2],character:f[3]});u={genOffset:O,sourceOffset:F}}}let c=r.createSourceFile("/a.tsx",t.code,r.ScriptTarget.ESNext);return c.statements[0]&&b.push({sourceRange:[0,e.length],generatedRange:[c.statements[0].getStart(c),t.code.length],data:{}}),{fileName:n+".tsx",kind:tn.FileKind.TypeScriptHostFile,capabilities:{codeAction:!0,documentFormatting:!1,diagnostic:!0,documentSymbol:!0,inlayHint:!0,foldingRange:!0},codegenStacks:[],snapshot:{getText:(o,f)=>t.code.substring(o,f),getLength:()=>t.code.length,getChangeRange:()=>{}},mappings:b,embeddedFiles:[]}}function Ur(e,t){let n=nn.default.basename(t,nn.default.extname(t)),r=n.startsWith("[")&&n.endsWith("]");return e.replace(/\b(\S*)__AstroComponent_/gm,(i,s)=>s?r?`_${s}_`:s[0].toUpperCase()+s.slice(1):n==="404"?"FourOhFour":i)}});var sn=q(ue=>{"use strict";Object.defineProperty(ue,"__esModule",{value:!0});ue.AstroFile=ue.getLanguageModule=void 0;var Qe=oe(),Nr=on();function $r(e){return{createVirtualFile(t,n){if(t.endsWith(".astro"))return new Re(t,n,e)},updateVirtualFile(t,n){t.update(n)}}}ue.getLanguageModule=$r;var Re=class{constructor(t,n,r){this.sourceFileName=t,this.snapshot=n,this.ts=r,this.kind=Qe.FileKind.TextFile,this.capabilities=Qe.FileCapabilities.full,this.codegenStacks=[],this.fileName=t,this.onSnapshotUpdated()}update(t){this.snapshot=t,this.onSnapshotUpdated()}onSnapshotUpdated(){this.mappings=[{sourceRange:[0,this.snapshot.getLength()],generatedRange:[0,this.snapshot.getLength()],data:Qe.FileRangeCapabilities.full}],this.embeddedFiles=[];let t=(0,Nr.astro2tsx)(this.snapshot.getText(0,this.snapshot.getLength()),this.fileName,this.ts);this.embeddedFiles.push(t.virtualFile)}};ue.AstroFile=Re});var Gr=oe(),Ye=Qt(),Jr=sn(),Ze=new WeakMap,Xr=e=>{let{typescript:t}=e;return{create(r){let i=(0,Gr.createVirtualFiles)([(0,Jr.getLanguageModule)(t)]);(0,Ye.decorateLanguageService)(i,r.languageService,!0),(0,Ye.decorateLanguageServiceHost)(i,r.languageServiceHost,t,[".astro"]);let s=r.languageServiceHost.getScriptKind?.bind(r.languageServiceHost.getScriptKind);return s&&(r.languageServiceHost.getScriptKind=y=>y.endsWith(".astro")?t.ScriptKind.TS:s(y)),r.languageService},getExternalFiles(r){return Ze.has(r)||Ze.set(r,(0,Ye.getExternalFiles)(t,r,[".astro"])),Ze.get(r)}}};module.exports=Xr;
